---
title: "Evolucion del nivel de estudios alcanzado por la poblacion española"
author: "Marco Javier Peñaloza Pérez"
date: "2023-04-25"
subtitle: Serie de tiempo
output: 
  html_document:
    toc: TRUE
    toc_float: TRUE
---

```{r setup, include=FALSE}
knitr::opts_chunk$set(echo = TRUE)
```

## **Introducción**

La evolución de la educación en España desde la década de 1960 ha sido un proceso significativo en la historia del país. Durante este período, la educación en España ha experimentado una serie de cambios importantes que han transformado radicalmente el sistema educativo y la forma en que se imparte la enseñanza, en el siguiente trabajo se realiza una exploración de una base de datos recogida con los porcentajes de habitantes que han alcanzado un nivel máximo de educación y cómo a través del tiempo se ha visto una mejora importante mejorando los índice de educación.

## **1.Definición del problema** 

La formación académica de las personas es una variable muy importante en la evolución de la sociedad, al pasar los años las diferentes naciones han implementado mecanismos que buscan que los habitantes de un país mejores sus niveles de educación. Tal es el caso de la población española, de la cual, se tiene una base de datos con los porcentaje de personas que pertenecen a un determinado nivel académico y que se ha visto evolucionado a medida que transcurre el tiempo, por tanto, se hace interesante hacer una exploración y análisis de la serie temporal para sacar conclusiones sobre el progreso y hacer estimaciones a futuro.


## **2. Justificación**

La propuesta de análisis de series de tiempo en educación en la población española es importante debido a que permite obtener información valiosa sobre la evolución de los niveles académicos mediante el análisis temporal y hacer pronósticos sobre lo que se puede esperar del fenómeno en si.

## **3. Objetivo**

Conocer la evolución temporal de los niveles de educación de España entre los años 1960 a 2020.

## **4. Metodología:**

### **4.1 Recopilación de datos:** 

Se recolectó información sobre el nivel educativo de la población en España, los cuales han sido tomados de la página: https://www.epdata.es/datos/educacion-espana-mundo-datos-graficos/274

### **4.2 Análisis exploratorio de datos:**

#### **4.2.1 Carga de la base de datos**

```{r, echo = TRUE, warning=FALSE, cache=FALSE, message=FALSE}
library(readxl)
data1 <- read_excel("C:/Users/mjpenalozap/Desktop/estudios en españa.xlsx")
head(data, n=6)
```
La base de datos nos da información sobre la fecha en que fueron recogidos los informes sobre los porcentajes de habitantes en españa que pertenecen a los niveles de educación primaria, secundaria y universitario.

### **4.2.2. Resumen estadístico de los datos**

```{r, echo = FALSE, warning=FALSE, cache=FALSE, message=FALSE}
summary(data1)
```
Se puede observar que lo datos han sido recogidos entre los años 1960 y 2019, existen 5 niveles de educación entre los que se encuentran:
Primaria
Primer ciclo de secundaria
Segundo ciclo de secundaria 
Primer ciclo de educación superior
Segundo ciclo de educación superior

En cada nivel se observa un resumen de 5 puntos con los valores mínimo, máximo y los tres cuartiles.

### **4.2.3. Histogramas de las variables**

```{r, echo = FALSE, warning=FALSE, cache=FALSE, message=FALSE}
library(ggplot2)
library(gridExtra)
variables_numericas <- sapply(data1, is.numeric)
graficos <- list()
for (variable in names(data1)[variables_numericas]) {
  grafico <- ggplot(data = data1, aes(x = data1[[variable]])) +
    geom_histogram(fill = "blue", color = "black") +
    labs(x = variable, y = "Frecuencia", title = paste("", variable))
  
  graficos[[variable]] <- grafico
}
gridExtra::grid.arrange(grobs = graficos, ncol = 2)
```

### **4.2.4 Creación del objeto ts**

### **Modificación de la base de datos:**

```{r echo=FALSE, warning=FALSE}
# Se cambia a formato de fecha
data1$fecha <- as.Date(paste0(data1$fecha))

# Se consolida la variable de interés
data1 <- aggregate(Primarios ~ fecha, data = data1, sum)

# Construir el objeto ts 
indice.ts <- ts(data1$Primarios, start = c(2018,1), frequency = 12)
indice.ts

#Gráfica
plot(indice.ts, main = "",ylab="valor",col="deepskyblue",xlab="fecha")
title(main = "Evolución de los estudios a nivel de Primaria")
```
**Análisis de la gráfica**
Se puede observar que a medida que han pasado los años el porcentaje de personas que sólo tenían nivel de primaria ha disminuido en España, esto quiere decir que el nivel académico fue mejorando con el tiempo.

**Grafica de Rezagos**

```{r echo=FALSE, warning=FALSE}
lag.plot(indice.ts, 9 , do.lines = FALSE)
```

### **Media Móvil**
Se procede a crear 3 medias móviles:

```{r}
library(zoo)
mediamovil1 <- rollmean(indice.ts,k=3)
cat("Media Movil con 3 meses: ", mediamovil1,"\n\n")

mediamovil2 <- rollmean(indice.ts,k=4)
cat("Media Movil con 4 meses: ", mediamovil2,"\n\n")

mediamovil3 <- rollmean(indice.ts,k=6)
cat("Media Movil con 6 meses: ", mediamovil3)
```
**Comparación de las medias con los datos originales de la base**


```{r echo=FALSE, warning=FALSE}

plot(1:length(indice.ts), indice.ts, type = "l",   
     ylim = c(min(indice.ts), max(indice.ts)),
     xlab = "Lineas de Serie de Tiempo", ylab = "Valores")
lines(1:length(mediamovil1),mediamovil1,type = "l", col=2)
lines(1:length(mediamovil2),mediamovil2,type = "l", col=3)
lines(1:length(mediamovil3),mediamovil3,type = "l", col=4)
legend("topleft",
       c("Indice.Ts", "Media Movil 3 Meses", "Media Movil 4 Meses", "Media Movil 6 Meses"),
       lty = 1, col = 1:4)
```

### **4.3 Modelado de series de tiempo:** 

se utilizarán técnicas de modelado de series de tiempo para analizar el comportamiento del rendimiento académico de los estudiantes a lo largo del tiempo y predecir su evolución futura.


## **5. Conclusiones:**



## **6. Referencias Bibliográficas**

1. EpData. (2019). Evolución del nivel de estudios alcanzado por la población española [Data set]. EpData - La actualidad informativa en datos estadísticos de Europa Press.